<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Information Theory | Theorem: Kraft-McMillan Inequality</title>
    <meta name="description" content="UvA course">
    <script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [ ['$','$'], ['\\(','\\)'] ],processEscapes: true}});</script>
  <script src="/assets/js/MathJax.js?config=TeX-AMS_HTML"></script>
  <script type="application/javascript">function timeout() {setTimeout(function() {MathJax.Hub.Queue(["Typeset", MathJax.Hub]);timeout();}, 1000)};MathJax.Hub.Queue(["Typeset", MathJax.Hub]);timeout();</script>
    
    <link rel="preload" href="/assets/css/styles.c0a0368e.css" as="style"><link rel="preload" href="/assets/js/app.c0a0368e.js" as="script"><link rel="preload" href="/assets/js/23.4463ce34.js" as="script"><link rel="prefetch" href="/assets/js/1.b42459b0.js"><link rel="prefetch" href="/assets/js/10.efcd0718.js"><link rel="prefetch" href="/assets/js/11.b96ece95.js"><link rel="prefetch" href="/assets/js/12.e1fc2cb5.js"><link rel="prefetch" href="/assets/js/13.281a42d7.js"><link rel="prefetch" href="/assets/js/14.321f3d63.js"><link rel="prefetch" href="/assets/js/15.2497a21d.js"><link rel="prefetch" href="/assets/js/16.55966313.js"><link rel="prefetch" href="/assets/js/17.99831763.js"><link rel="prefetch" href="/assets/js/18.b2da39df.js"><link rel="prefetch" href="/assets/js/19.783f6fe5.js"><link rel="prefetch" href="/assets/js/2.4174b9dd.js"><link rel="prefetch" href="/assets/js/20.31a487d3.js"><link rel="prefetch" href="/assets/js/21.a011af4c.js"><link rel="prefetch" href="/assets/js/22.e03bc349.js"><link rel="prefetch" href="/assets/js/24.b076e7c4.js"><link rel="prefetch" href="/assets/js/25.a123cda5.js"><link rel="prefetch" href="/assets/js/26.c5548a4d.js"><link rel="prefetch" href="/assets/js/27.91697a5a.js"><link rel="prefetch" href="/assets/js/28.26582aab.js"><link rel="prefetch" href="/assets/js/29.cc517640.js"><link rel="prefetch" href="/assets/js/3.4c5adbde.js"><link rel="prefetch" href="/assets/js/30.3ca179bc.js"><link rel="prefetch" href="/assets/js/31.3e961e9b.js"><link rel="prefetch" href="/assets/js/32.eb1a29f5.js"><link rel="prefetch" href="/assets/js/33.14f4f43a.js"><link rel="prefetch" href="/assets/js/34.af720415.js"><link rel="prefetch" href="/assets/js/35.d285264b.js"><link rel="prefetch" href="/assets/js/36.44d3152b.js"><link rel="prefetch" href="/assets/js/37.b076d761.js"><link rel="prefetch" href="/assets/js/38.ad1f27c7.js"><link rel="prefetch" href="/assets/js/39.413161ea.js"><link rel="prefetch" href="/assets/js/4.15836b88.js"><link rel="prefetch" href="/assets/js/40.ba4bef5e.js"><link rel="prefetch" href="/assets/js/41.6fbb1017.js"><link rel="prefetch" href="/assets/js/42.80c5b28a.js"><link rel="prefetch" href="/assets/js/43.3f0aeafe.js"><link rel="prefetch" href="/assets/js/44.c08a8e84.js"><link rel="prefetch" href="/assets/js/45.2da068e9.js"><link rel="prefetch" href="/assets/js/46.cf98a01d.js"><link rel="prefetch" href="/assets/js/47.95ad89e2.js"><link rel="prefetch" href="/assets/js/48.11de7b32.js"><link rel="prefetch" href="/assets/js/49.89191d18.js"><link rel="prefetch" href="/assets/js/5.64f16959.js"><link rel="prefetch" href="/assets/js/50.d3c00218.js"><link rel="prefetch" href="/assets/js/51.270d7491.js"><link rel="prefetch" href="/assets/js/52.e303f682.js"><link rel="prefetch" href="/assets/js/53.6b37d452.js"><link rel="prefetch" href="/assets/js/54.5516a56a.js"><link rel="prefetch" href="/assets/js/55.1535f45c.js"><link rel="prefetch" href="/assets/js/56.fe5d6cd5.js"><link rel="prefetch" href="/assets/js/57.c78d418a.js"><link rel="prefetch" href="/assets/js/58.6a5328b4.js"><link rel="prefetch" href="/assets/js/59.9c425111.js"><link rel="prefetch" href="/assets/js/6.56b74cc5.js"><link rel="prefetch" href="/assets/js/60.8471b9ec.js"><link rel="prefetch" href="/assets/js/61.7f1373c2.js"><link rel="prefetch" href="/assets/js/62.3fa31180.js"><link rel="prefetch" href="/assets/js/63.9778d19f.js"><link rel="prefetch" href="/assets/js/64.7ec547c6.js"><link rel="prefetch" href="/assets/js/65.46b6abc2.js"><link rel="prefetch" href="/assets/js/66.41e96d6e.js"><link rel="prefetch" href="/assets/js/67.1e438865.js"><link rel="prefetch" href="/assets/js/68.ec61f597.js"><link rel="prefetch" href="/assets/js/69.a4ad7ed9.js"><link rel="prefetch" href="/assets/js/7.6e55be9c.js"><link rel="prefetch" href="/assets/js/70.ad9257f5.js"><link rel="prefetch" href="/assets/js/71.e45ee61f.js"><link rel="prefetch" href="/assets/js/72.cf56042d.js"><link rel="prefetch" href="/assets/js/73.5190c50f.js"><link rel="prefetch" href="/assets/js/74.a5427366.js"><link rel="prefetch" href="/assets/js/75.ea188344.js"><link rel="prefetch" href="/assets/js/76.69afb87b.js"><link rel="prefetch" href="/assets/js/77.91aca632.js"><link rel="prefetch" href="/assets/js/78.e5c052d0.js"><link rel="prefetch" href="/assets/js/79.a790ac95.js"><link rel="prefetch" href="/assets/js/8.ef38795e.js"><link rel="prefetch" href="/assets/js/80.65aec641.js"><link rel="prefetch" href="/assets/js/81.78289e97.js"><link rel="prefetch" href="/assets/js/82.08de41e8.js"><link rel="prefetch" href="/assets/js/83.ff9c1755.js"><link rel="prefetch" href="/assets/js/84.f86545fe.js"><link rel="prefetch" href="/assets/js/85.c883b25b.js"><link rel="prefetch" href="/assets/js/86.1d29daeb.js"><link rel="prefetch" href="/assets/js/87.9c24da6f.js"><link rel="prefetch" href="/assets/js/88.bcbf388d.js"><link rel="prefetch" href="/assets/js/89.e3aaff55.js"><link rel="prefetch" href="/assets/js/9.3f4a2127.js"><link rel="prefetch" href="/assets/js/90.23eda780.js"><link rel="prefetch" href="/assets/js/91.da84bead.js"><link rel="prefetch" href="/assets/js/92.7d2a6af1.js"><link rel="prefetch" href="/assets/js/93.4de0373f.js">
    <link rel="stylesheet" href="/assets/css/styles.c0a0368e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/" class="home-link router-link-active"><!----><span class="site-name">
      Information Theory
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><!----></div></header><div class="sidebar-mask"></div><div class="sidebar"><!----><ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading"><span>general information</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>01 probability theory</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>02 entropy</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>03 source coding data compression</span><span class="arrow down"></span></p><ul class="sidebar-group-items"><li><a href="/03-source-coding-data-compression/introduction-to-source-coding/" class="sidebar-link">Introduction to Source Coding</a></li><li><a href="/03-source-coding-data-compression/symbol-codes/definition-sources-and-codes/" class="sidebar-link">Definition: Sources and Codes</a></li><li><a href="/03-source-coding-data-compression/symbol-codes/definition-unique-decodability/" class="sidebar-link">Definition: Unique decodability</a></li><li><a href="/03-source-coding-data-compression/symbol-codes/definition-prefix-freeness/" class="sidebar-link">Definition: Prefix-freeness</a></li><li><a href="/03-source-coding-data-compression/codeword-length/definition-minimal-average-length/" class="sidebar-link">Definition: (Minimal) Average Length</a></li><li><a href="/03-source-coding-data-compression/codeword-length/theorem-kraft-mcmillan-inequality/" class="active sidebar-link">Theorem: Kraft-McMillan Inequality</a></li><li><a href="/03-source-coding-data-compression/codeword-length/visualisation-of-symbol-codes-as-trees/" class="sidebar-link">Visualisation of Symbol Codes as Trees</a></li><li><a href="/03-source-coding-data-compression/codeword-length/theorem-shannons-source-coding-theorem-optimal-codes/" class="sidebar-link">Theorem: Shannon's Source-Coding Theorem (Optimal Codes)</a></li><li><a href="/03-source-coding-data-compression/source-coding-algorithms/definition-huffman-codes/" class="sidebar-link">Definition: Huffman Codes</a></li><li><a href="/03-source-coding-data-compression/source-coding-algorithms/definition-ternary-huffman-codes/" class="sidebar-link">Definition: Ternary Huffman Codes</a></li><li><a href="/03-source-coding-data-compression/source-coding-algorithms/advantages-and-disadvantages-of-huffman-codes/" class="sidebar-link">Advantages and Disadvantages of Huffman Codes</a></li><li><a href="/03-source-coding-data-compression/source-coding-algorithms/hangman/" class="sidebar-link">Hangman</a></li><li><a href="/03-source-coding-data-compression/source-coding-algorithms/definition-binary-representation-binary-intervals/" class="sidebar-link">Definition: Binary Representation &amp; Binary Intervals</a></li><li><a href="/03-source-coding-data-compression/source-coding-algorithms/arithmetic-codes/" class="sidebar-link">Arithmetic Codes</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>04 typical sets and encryption</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>05 random processes</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>06 error correction and zero error transmission</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>07 noisy channel coding</span><span class="arrow right"></span></p><!----></div></li></ul></div><div class="page"><div class="content"><h1 id="theorem-kraft-mcmillan-inequality"><a href="#theorem-kraft-mcmillan-inequality" aria-hidden="true" class="header-anchor">#</a> Theorem: Kraft-McMillan Inequality</h1><p>The two following theorems give necessary and sufficient conditions for the existence of a prefix-free code or a uniquely decodable code for a given set of codeword lengths.</p><div class="content-box pad-box-mini border border-trbl border-round"><h4 style="color: #bc0031;"><strong>Theorem: Kraft's inequality</strong></h4>
Let \(\{\ell_1, \ell_2, \ldots, \ell_m \}\) be a set of \(m\) positive natural numbers. There exists a prefix-free code with image \({\cal C} = \{c_1, \ldots, c_m\}\) and codeword lengths \(\ell(c_i) = \ell_i\), if and only if \[ \sum_{i=1}^m 2^{-\ell_i} \leq 1. \]
<p><span role="button" aria-controls="group4" aria-label="Toggler" aria-expanded="false" class="element_toggler"><span class="Button">\(\Rightarrow\)</span></span></p><div id="group4">For the forward direction, suppose we have a prefix-free code \(C\) with image \({\cal C} = \{c_1, \ldots, c_m\}\) and codeword lengths \(\ell(c_i) = \ell_i \). View this code as a tree, with codewords only on the leaves (but not necessarily all the leaves), and assign a weight of \(2^{-d}\) to every node in the tree at depth \(d\) (including the leaves):
<p><img src="https://canvas.uva.nl/courses/2205/files/207712/preview?verifier=jqDwg3qkygBSbXEpSgKvKR5pQ253L3dhltqYGPUZ" alt="-" width="124" height="170" data-api-endpoint="https://canvas.uva.nl/api/v1/courses/2205/files/207712" data-api-returntype="File" style="display: block; margin-left: auto; margin-right: auto;"><a title="proof-kraft.svg" href="https://canvas.uva.nl/courses/2205/files/207712/download?verifier=jqDwg3qkygBSbXEpSgKvKR5pQ253L3dhltqYGPUZ&wrap=1" data-api-endpoint="https://canvas.uva.nl/api/v1/courses/2205/files/207712" data-api-returntype="File" class="instructure_file_link"></a></p>
Note that the weight of each node is exactly the sum of the weight of its direct children, and thereby that the weight of the root is exactly the weight of all of the leaves. Since every codeword \(c_i\) resides on a leaf of depth \(\ell_i\) (but not all leaves are necessarily occupied), the weight of the root is <i>at least</i> the sum of all the codeword weights: \[ \sum_{i=1}^{m} 2^{-\ell_i} \leq 2^0 = 1. \]</div><p><span role="button" aria-controls="group5" aria-label="Toggler" aria-expanded="false" class="element_toggler"><span class="Button">\(\Leftarrow\)</span></span></p><div id="group5">Shopping at the codeword supermarket as described in the following video: <a id="media_comment_maybe" title="03MacKayShoppingCodewords.MP4" href="https://canvas.uva.nl/courses/2205/files/190998/download?verifier=dTZeDTTYdf0l2s5N6gkjYDxVva70uXqPIJ9b8IIB&wrap=1" data-api-endpoint="https://canvas.uva.nl/api/v1/courses/2205/files/190998" data-api-returntype="File" class="instructure_file_link instructure_video_link">03MacKayShoppingCodewords.MP4</a></div></div><p>A stronger version of Kraft's inequality holds as well, this time for uniquely decodable codes:</p><div class="content-box pad-box-mini border border-trbl border-round"><h4 style="color: #bc0031;"><strong>Theorem: McMillan inequality</strong></h4>
For a uniquely decodable code with image \({\cal C} = \{c_1, \ldots, c_m\}\) and codeword lengths \(\ell_i := \ell(c_i)\), it holds that \[ \sum_{i=1}^m 2^{-\ell_i} \leq 1. \]
<p><span role="button" aria-controls="group6" aria-label="Toggler" aria-expanded="false" class="element_toggler"><span class="Button">Proof</span></span></p><div id="group6"><div class="content-box">Let \({\cal C}\) be a uniquely decodable code as in the theorem statement. We can write \[ S := \sum_{c \in \cal C} \frac{1}{2^{\ell(c)}} = \sum_{\ell = L_{\min}}^{L_{\max}} \frac{n_\ell}{2^\ell} \] where \(L_{\min} = \min_{c \in \cal C} \ell(c)\), \(L_{\max} = \max_{c \in \cal C} \ell(c)\), and \(n_{\ell} = |\{c \in {\cal C}\mid \ell(c) = \ell\}|\). Furthermore, for any \(k \in \mathbb{N}\), consider the \(k\)th power of \(S\), \[ S^k = \sum_{c_1,\ldots,c_k \in \mathcal{C}^k} \frac{1}{2^{\ell(c_1)+\ldots+\ell(c_k)}} = \sum_{\ell = k L_{\min}}^{k L_{\max}} \frac{n_\ell^{(k)}}{2^\ell} \] where \(n_\ell^{(k)}\) is defined as \(n_\ell^{(k)} = \big|\big\{(c_1,\ldots,c_k) \in {\cal C}^k \mid \sum_i\ell(c_i) = \ell(c_1|\ldots|c_k) = \ell\big\}\big|\). Note that \[ n_\ell^{(k)} = \sum_{x \in \{0,1\}^{\ell}} \big|\{(c_1,\ldots,c_k) \in {\cal C}^k \mid \,c_1|\ldots|c_k = x\}\big| \leq \sum_{x \in \{0,1\}^{\ell}} 1 = 2^{\ell} \] where the inequality follows from the unique decodability of \(\cal C\). Thus, we can conclude that \[ S^k \leq (L_{\max} - L_{\min}) \cdot k \] for all \(k \in \mathbb{N}\), so \(S^k\) grows at most linearly in \(k\), from which follows that \(S \leq 1\) (for if not, \(S^k\) would grow exponentially in \(k\)).</div></div></div><p>Kraft's and McMillan's inequality together lead to the conclusion that the lengths of an optimal prefix-free code and an optimal uniquely decodable code coincide:</p><div class="content-box pad-box-mini border border-trbl border-round"><h4 style="color: #bc0031;"><strong>Corollary</strong></h4>
Let \(P_X\) be a source. For every uniquely decodable code \(C\), there exists a prefix-free code \(C'\) such that \(\ell_C(P_X) = \ell_{C'}(P_X)\). Hence, \[ \ell_{\min}^{\text{p.f.}}(P_X) = \ell_{\min}^{\text{u.d.}}(P_X). \]</div><p>From now on, we will just write \(\ell_{\min}(P_X)\) to denote either of these measures for average length. A code \(C\) for which \(\ell_C(P_X) = \ell_{\min}(P_X)\) is called <span style="color: #bc0031;"><strong>optimal</strong></span> for the source \(P_X\).</p></div><!----><div class="content page-nav"><p class="inner"><span class="prev">
        ← <a href="/03-source-coding-data-compression/codeword-length/definition-minimal-average-length/" class="prev">
          Definition: (Minimal) Average Length
        </a></span><span class="next"><a href="/03-source-coding-data-compression/codeword-length/visualisation-of-symbol-codes-as-trees/">
          Visualisation of Symbol Codes as Trees
        </a> →
      </span></p></div></div></div></div>
    <script src="/assets/js/23.4463ce34.js" defer></script><script src="/assets/js/app.c0a0368e.js" defer></script>
  </body>
</html>
