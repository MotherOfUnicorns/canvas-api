<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Information Theory | Arithmetic Codes</title>
    <meta name="description" content="UvA course">
    <script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [ ['$','$'], ['\\(','\\)'] ],processEscapes: true}});</script>
  <script src="/assets/js/MathJax.js?config=TeX-AMS_HTML"></script>
  <script type="application/javascript">function timeout() {setTimeout(function() {MathJax.Hub.Queue(["Typeset", MathJax.Hub]);timeout();}, 1000)};MathJax.Hub.Queue(["Typeset", MathJax.Hub]);timeout();</script>
    
    <link rel="preload" href="/assets/css/styles.c0a0368e.css" as="style"><link rel="preload" href="/assets/js/app.c0a0368e.js" as="script"><link rel="preload" href="/assets/js/28.26582aab.js" as="script"><link rel="prefetch" href="/assets/js/1.b42459b0.js"><link rel="prefetch" href="/assets/js/10.efcd0718.js"><link rel="prefetch" href="/assets/js/11.b96ece95.js"><link rel="prefetch" href="/assets/js/12.e1fc2cb5.js"><link rel="prefetch" href="/assets/js/13.281a42d7.js"><link rel="prefetch" href="/assets/js/14.321f3d63.js"><link rel="prefetch" href="/assets/js/15.2497a21d.js"><link rel="prefetch" href="/assets/js/16.55966313.js"><link rel="prefetch" href="/assets/js/17.99831763.js"><link rel="prefetch" href="/assets/js/18.b2da39df.js"><link rel="prefetch" href="/assets/js/19.783f6fe5.js"><link rel="prefetch" href="/assets/js/2.4174b9dd.js"><link rel="prefetch" href="/assets/js/20.31a487d3.js"><link rel="prefetch" href="/assets/js/21.a011af4c.js"><link rel="prefetch" href="/assets/js/22.e03bc349.js"><link rel="prefetch" href="/assets/js/23.4463ce34.js"><link rel="prefetch" href="/assets/js/24.b076e7c4.js"><link rel="prefetch" href="/assets/js/25.a123cda5.js"><link rel="prefetch" href="/assets/js/26.c5548a4d.js"><link rel="prefetch" href="/assets/js/27.91697a5a.js"><link rel="prefetch" href="/assets/js/29.cc517640.js"><link rel="prefetch" href="/assets/js/3.4c5adbde.js"><link rel="prefetch" href="/assets/js/30.3ca179bc.js"><link rel="prefetch" href="/assets/js/31.3e961e9b.js"><link rel="prefetch" href="/assets/js/32.eb1a29f5.js"><link rel="prefetch" href="/assets/js/33.14f4f43a.js"><link rel="prefetch" href="/assets/js/34.af720415.js"><link rel="prefetch" href="/assets/js/35.d285264b.js"><link rel="prefetch" href="/assets/js/36.44d3152b.js"><link rel="prefetch" href="/assets/js/37.b076d761.js"><link rel="prefetch" href="/assets/js/38.ad1f27c7.js"><link rel="prefetch" href="/assets/js/39.413161ea.js"><link rel="prefetch" href="/assets/js/4.15836b88.js"><link rel="prefetch" href="/assets/js/40.ba4bef5e.js"><link rel="prefetch" href="/assets/js/41.6fbb1017.js"><link rel="prefetch" href="/assets/js/42.80c5b28a.js"><link rel="prefetch" href="/assets/js/43.3f0aeafe.js"><link rel="prefetch" href="/assets/js/44.c08a8e84.js"><link rel="prefetch" href="/assets/js/45.2da068e9.js"><link rel="prefetch" href="/assets/js/46.cf98a01d.js"><link rel="prefetch" href="/assets/js/47.95ad89e2.js"><link rel="prefetch" href="/assets/js/48.11de7b32.js"><link rel="prefetch" href="/assets/js/49.89191d18.js"><link rel="prefetch" href="/assets/js/5.64f16959.js"><link rel="prefetch" href="/assets/js/50.d3c00218.js"><link rel="prefetch" href="/assets/js/51.270d7491.js"><link rel="prefetch" href="/assets/js/52.e303f682.js"><link rel="prefetch" href="/assets/js/53.6b37d452.js"><link rel="prefetch" href="/assets/js/54.5516a56a.js"><link rel="prefetch" href="/assets/js/55.1535f45c.js"><link rel="prefetch" href="/assets/js/56.fe5d6cd5.js"><link rel="prefetch" href="/assets/js/57.c78d418a.js"><link rel="prefetch" href="/assets/js/58.6a5328b4.js"><link rel="prefetch" href="/assets/js/59.9c425111.js"><link rel="prefetch" href="/assets/js/6.56b74cc5.js"><link rel="prefetch" href="/assets/js/60.8471b9ec.js"><link rel="prefetch" href="/assets/js/61.7f1373c2.js"><link rel="prefetch" href="/assets/js/62.3fa31180.js"><link rel="prefetch" href="/assets/js/63.9778d19f.js"><link rel="prefetch" href="/assets/js/64.7ec547c6.js"><link rel="prefetch" href="/assets/js/65.46b6abc2.js"><link rel="prefetch" href="/assets/js/66.41e96d6e.js"><link rel="prefetch" href="/assets/js/67.1e438865.js"><link rel="prefetch" href="/assets/js/68.ec61f597.js"><link rel="prefetch" href="/assets/js/69.a4ad7ed9.js"><link rel="prefetch" href="/assets/js/7.6e55be9c.js"><link rel="prefetch" href="/assets/js/70.ad9257f5.js"><link rel="prefetch" href="/assets/js/71.e45ee61f.js"><link rel="prefetch" href="/assets/js/72.cf56042d.js"><link rel="prefetch" href="/assets/js/73.5190c50f.js"><link rel="prefetch" href="/assets/js/74.a5427366.js"><link rel="prefetch" href="/assets/js/75.ea188344.js"><link rel="prefetch" href="/assets/js/76.69afb87b.js"><link rel="prefetch" href="/assets/js/77.91aca632.js"><link rel="prefetch" href="/assets/js/78.e5c052d0.js"><link rel="prefetch" href="/assets/js/79.a790ac95.js"><link rel="prefetch" href="/assets/js/8.ef38795e.js"><link rel="prefetch" href="/assets/js/80.65aec641.js"><link rel="prefetch" href="/assets/js/81.78289e97.js"><link rel="prefetch" href="/assets/js/82.08de41e8.js"><link rel="prefetch" href="/assets/js/83.ff9c1755.js"><link rel="prefetch" href="/assets/js/84.f86545fe.js"><link rel="prefetch" href="/assets/js/85.c883b25b.js"><link rel="prefetch" href="/assets/js/86.1d29daeb.js"><link rel="prefetch" href="/assets/js/87.9c24da6f.js"><link rel="prefetch" href="/assets/js/88.bcbf388d.js"><link rel="prefetch" href="/assets/js/89.e3aaff55.js"><link rel="prefetch" href="/assets/js/9.3f4a2127.js"><link rel="prefetch" href="/assets/js/90.23eda780.js"><link rel="prefetch" href="/assets/js/91.da84bead.js"><link rel="prefetch" href="/assets/js/92.7d2a6af1.js"><link rel="prefetch" href="/assets/js/93.4de0373f.js">
    <link rel="stylesheet" href="/assets/css/styles.c0a0368e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/" class="home-link router-link-active"><!----><span class="site-name">
      Information Theory
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><!----></div></header><div class="sidebar-mask"></div><div class="sidebar"><!----><ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading"><span>general information</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>01 probability theory</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>02 entropy</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>03 source coding data compression</span><span class="arrow down"></span></p><ul class="sidebar-group-items"><li><a href="/03-source-coding-data-compression/introduction-to-source-coding/" class="sidebar-link">Introduction to Source Coding</a></li><li><a href="/03-source-coding-data-compression/symbol-codes/definition-sources-and-codes/" class="sidebar-link">Definition: Sources and Codes</a></li><li><a href="/03-source-coding-data-compression/symbol-codes/definition-unique-decodability/" class="sidebar-link">Definition: Unique decodability</a></li><li><a href="/03-source-coding-data-compression/symbol-codes/definition-prefix-freeness/" class="sidebar-link">Definition: Prefix-freeness</a></li><li><a href="/03-source-coding-data-compression/codeword-length/definition-minimal-average-length/" class="sidebar-link">Definition: (Minimal) Average Length</a></li><li><a href="/03-source-coding-data-compression/codeword-length/theorem-kraft-mcmillan-inequality/" class="sidebar-link">Theorem: Kraft-McMillan Inequality</a></li><li><a href="/03-source-coding-data-compression/codeword-length/visualisation-of-symbol-codes-as-trees/" class="sidebar-link">Visualisation of Symbol Codes as Trees</a></li><li><a href="/03-source-coding-data-compression/codeword-length/theorem-shannons-source-coding-theorem-optimal-codes/" class="sidebar-link">Theorem: Shannon's Source-Coding Theorem (Optimal Codes)</a></li><li><a href="/03-source-coding-data-compression/source-coding-algorithms/definition-huffman-codes/" class="sidebar-link">Definition: Huffman Codes</a></li><li><a href="/03-source-coding-data-compression/source-coding-algorithms/definition-ternary-huffman-codes/" class="sidebar-link">Definition: Ternary Huffman Codes</a></li><li><a href="/03-source-coding-data-compression/source-coding-algorithms/advantages-and-disadvantages-of-huffman-codes/" class="sidebar-link">Advantages and Disadvantages of Huffman Codes</a></li><li><a href="/03-source-coding-data-compression/source-coding-algorithms/hangman/" class="sidebar-link">Hangman</a></li><li><a href="/03-source-coding-data-compression/source-coding-algorithms/definition-binary-representation-binary-intervals/" class="sidebar-link">Definition: Binary Representation &amp; Binary Intervals</a></li><li><a href="/03-source-coding-data-compression/source-coding-algorithms/arithmetic-codes/" class="active sidebar-link">Arithmetic Codes</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>04 typical sets and encryption</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>05 random processes</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>06 error correction and zero error transmission</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>07 noisy channel coding</span><span class="arrow right"></span></p><!----></div></li></ul></div><div class="page"><div class="content"><h1 id="arithmetic-codes"><a href="#arithmetic-codes" aria-hidden="true" class="header-anchor">#</a> Arithmetic Codes</h1><p>Visualization using &quot;language model&quot; of controller presses (X,Y,A,B)</p><p></p><p>In this section, we study a different kind of code that can handle context-dependent distributions, unlike the Huffman code. Binary representations of numbers in the interval \([0,1)\) as studied in the previous exercise give rise to a very elegant code:</p><div class="content-box pad-box-mini border border-trbl border-round"><h4 style="color: #bc0031;"><strong>Definition: Arithmetic code</strong></h4>
Given a source \(P_X\) with \(\mathcal{X} = \{x_1, .., x_m\}\), construct the arithmetic code as follows. Divide the interval \([0,1)\) into disjoint subintervals \(I_{x_j} = [a_j, a_{j+1})\), where \(a_1, \ldots, a_{m+1}\) are defined such that \(a_{j+1} - a_j = P_X(x_j)\), and \(a_1 = 0, a_{m+1} = 1\). The encoding \(AC(x_j)\) of the element \(x_j\) is the (shortest possible) standard binary representation of some number in the interval \(I_{x_j}\).</div><div class="content-box pad-box-mini border border-trbl border-round"><h4 style="color: #2d3b45;"><strong>Example</strong></h4>
Let \(X\) be a random variable with \(\mathcal{X} = \{1,2,3\}\) and \(P_X(1) = \frac{1}{2}\), \(P_X(2) = P_X(3) = \frac{1}{4}\). The arithmetic code is constructed by first determining the intervals:
<div class="content-box pad-box-mini"><img src="https://canvas.uva.nl/courses/2205/files/181295/download?verifier=FRv17xCeUI1MtnvU3BalQhLHz6kw8kRfuNqAdmUy" alt="minimal-12.svg" data-api-endpoint="https://canvas.uva.nl/api/v1/courses/2205/files/181295" data-api-returntype="File" style="display: block; margin-left: auto; margin-right: auto;"></div>
This image results in the arithmetic code \(\mathcal{C}\) with \(\mathcal{C}(1) = 0\) (the representation of 0), \(\mathcal{C}(2) = 1\) (the representation of \(\frac{1}{2}\)), \(\mathcal{C}(2) = 11\) (the representation of \(\frac{3}{4}\)). For \(P_X\), the codewords happen to fall exactly <i>on</i> the boundaries of the intervals. This is not always the case, however. The same code would have resulted from this procedure if we started with the random variable \(Y\) with \(\mathcal{Y} = \{1,2,3\}\) and \(P_Y(1) = P_Y(2) = 0.3\) and \(P_Y(3) = 0.4\):
<div class="content-box pad-box-mini "><img src="https://canvas.uva.nl/courses/2205/files/181296/download?verifier=SvuNm2TDBiT1MZPEfyMZP0VbRnWUBR8y7423Bndk&wrap=1" alt="minimal-13.svg" data-api-endpoint="https://canvas.uva.nl/api/v1/courses/2205/files/181296" data-api-returntype="File" style="display: block; margin-left: auto; margin-right: auto;"></div></div><div class="content-box pad-box-mini border border-trbl border-round"><h4 style="color: #bc0031;"><strong>Proposition</strong></h4>
For any \((X,P_X)\), the arithmetic code has average length \(\ell_{AC}(P_X) \leq H(X) + 1\).
<p><span role="button" aria-controls="group14" aria-label="Toggler" aria-expanded="false" class="element_toggler"><span class="Button">Proof</span></span></p><div id="group14"><div class="content-box">Let \(x \in \mathcal{X}\), and define \(\ell_x := \lceil \log (1/P_X(x))\rceil\) to be the rounded surprisal value of \(x\). Then \begin{align} 2^{-\ell_x} = 2^{-\lceil \log (1/P_X(x))\rceil} \leq 2^{-\log (1/P_X(x))} = 2^{\log P_X(x)} = P_X(x). \end{align} Therefore, since the size of the interval \(I_x\) is \(P_X(x)\), there must exist an integer \(0 \leq s_x &lt; 2^{\ell_x}\) such that \(s_x \cdot 2^{-\ell_x}\) lies in the interval \(I_x\). This number \(s_x \cdot 2^{-\ell_x}\) has a binary representation of length \(\ell_x \leq -\log P_X(x) + 1\). Repeating this argument for every \(x\), we obtain \begin{align} \ell_{AC}(P_X) = \mathbb{E}[\ell(AC(X))] = \sum_x P_X(x) \ell(AC(x)) \leq \sum_x P_X(x) (-\log P_X(x) + 1) = H(X) + 1. \end{align}</div></div></div><p>As we can see from the example above, this construction for arithmetic codes does not necessarily yield prefix-free codes. However, at the expense of one extra bit of code (on average), the construction can be adapted into a prefix-free code. One example of this is the <span style="color: #bc0031;"><strong>Shannon-Fano-Elias code</strong></span> (see <a href="http://onlinelibrary.wiley.com/book/10.1002/0471200611" target="_blank">Cover/Thomas</a>, Section 5.9 or <a href="https://en.wikipedia.org/wiki/Shannon%E2%80%93Fano%E2%80%93Elias_coding">Wikipedia</a>), which provides a more sophisticated way of selecting a number within each interval than simply selecting the number with the shortest binary representation. This alternative selection procedure ensures prefix-freeness. Another option is to select <i>binary intervals</i> within each interval:</p><div class="content-box pad-box-mini border border-trbl border-round"><h4 style="color: #bc0031;"><strong>Definition: Arithmetic code (prefix-free version)</strong></h4>
A prefix-free arithmetic code is identical to the definition above, except that the encoding \(AC^{pf}(x_j)\) of the element \(x_j\) is now the name of a largest binary interval that fits entirely in \(I_{x_j}\).</div><p>Similarly to the proposition above, it can be shown that for any source \(P_X\), \(\ell_{AC^{pf}}(P_X) \leq H(X) + 2\). Note that we get prefix-freeness only at the expense of an extra bit on average.</p><div class="content-box pad-box-mini border border-trbl border-round"><h4 style="color: #2d3b45;"><strong>Example</strong></h4>
Let \(Y\) be the random variable as in the example above, that is, \(P_Y(1) = P_Y(2) = 0.3\) and \(P_Y(3) = 0.4\). The prefix-free code for \(Y\) is constructed as follows: <br><img src="https://canvas.uva.nl/courses/2205/files/519668/preview?verifier=VmBKp14wgj38zJ67pwlPJQmRLREDGDSmJgYm8g6c" alt="ArithmeticCode.png" data-api-endpoint="https://canvas.uva.nl/api/v1/courses/2205/files/519668" data-api-returntype="File"><br>This results in the codewords \(\mathcal{C}(1) = 00\), \(\mathcal{C}(2) = 011\), and \(\mathcal{C}(3) = 11\).</div><p>The arithmetic code is slightly less efficient than the Huffman code in terms of average codeword length. A big advantage is the way it is able to adapt to changing distributions, such as when we are encoding a stream of English text. Suppose we are given the (not necessarily i.i.d.) random variables \(X_1, X_2, \ldots, X_n\), and we want to encode the source \(P_{X_1X_2 \cdots X_n}\). We start by dividing the interval \([0,1)\) into subintervals according to \(P_{X_1}\). If, for example, the event \(X_1 = b\) happens, we zoom into the interval corresponding to \(b\), and subdivide <i>that</i> interval according to \(P_{X_2|X_1}\), so that the sizes of these intervals add up to \(P_{X_1}(b)\).</p><p>The concept of arithmetic coding is exploited as an accessibility tool in the keyboard alternative <a href="http://wol.ra.phy.cam.ac.uk/dasher/">Dasher</a>, invented by the group of David MacKay at Cambridge University, UK. Try to download and play with it, it's great fun!</p><p><img src="http://www.inference.org.uk/dasher/images/newdasher.gif" alt="Demo of Dasher" width="250" height="230"></p></div><!----><div class="content page-nav"><p class="inner"><span class="prev">
        ← <a href="/03-source-coding-data-compression/source-coding-algorithms/definition-binary-representation-binary-intervals/" class="prev">
          Definition: Binary Representation &amp; Binary Intervals
        </a></span><span class="next"><a href="/04-typical-sets-and-encryption/typical-sets/convergence-of-random-variables/">
          Convergence of Random Variables
        </a> →
      </span></p></div></div></div></div>
    <script src="/assets/js/28.26582aab.js" defer></script><script src="/assets/js/app.c0a0368e.js" defer></script>
  </body>
</html>
