<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Information Theory | Source Coding using Typical Sets</title>
    <meta name="description" content="UvA course">
    <script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [ ['$','$'], ['\\(','\\)'] ],processEscapes: true}});</script>
  <script src="/assets/js/MathJax.js?config=TeX-AMS_HTML"></script>
  <script type="application/javascript">function timeout() {setTimeout(function() {MathJax.Hub.Queue(["Typeset", MathJax.Hub]);timeout();}, 1000)};MathJax.Hub.Queue(["Typeset", MathJax.Hub]);timeout();</script>
    
    <link rel="preload" href="/assets/css/styles.c0a0368e.css" as="style"><link rel="preload" href="/assets/js/app.c0a0368e.js" as="script"><link rel="preload" href="/assets/js/45.2da068e9.js" as="script"><link rel="prefetch" href="/assets/js/1.b42459b0.js"><link rel="prefetch" href="/assets/js/10.efcd0718.js"><link rel="prefetch" href="/assets/js/11.b96ece95.js"><link rel="prefetch" href="/assets/js/12.e1fc2cb5.js"><link rel="prefetch" href="/assets/js/13.281a42d7.js"><link rel="prefetch" href="/assets/js/14.321f3d63.js"><link rel="prefetch" href="/assets/js/15.2497a21d.js"><link rel="prefetch" href="/assets/js/16.55966313.js"><link rel="prefetch" href="/assets/js/17.99831763.js"><link rel="prefetch" href="/assets/js/18.b2da39df.js"><link rel="prefetch" href="/assets/js/19.783f6fe5.js"><link rel="prefetch" href="/assets/js/2.4174b9dd.js"><link rel="prefetch" href="/assets/js/20.31a487d3.js"><link rel="prefetch" href="/assets/js/21.a011af4c.js"><link rel="prefetch" href="/assets/js/22.e03bc349.js"><link rel="prefetch" href="/assets/js/23.4463ce34.js"><link rel="prefetch" href="/assets/js/24.b076e7c4.js"><link rel="prefetch" href="/assets/js/25.a123cda5.js"><link rel="prefetch" href="/assets/js/26.c5548a4d.js"><link rel="prefetch" href="/assets/js/27.91697a5a.js"><link rel="prefetch" href="/assets/js/28.26582aab.js"><link rel="prefetch" href="/assets/js/29.cc517640.js"><link rel="prefetch" href="/assets/js/3.4c5adbde.js"><link rel="prefetch" href="/assets/js/30.3ca179bc.js"><link rel="prefetch" href="/assets/js/31.3e961e9b.js"><link rel="prefetch" href="/assets/js/32.eb1a29f5.js"><link rel="prefetch" href="/assets/js/33.14f4f43a.js"><link rel="prefetch" href="/assets/js/34.af720415.js"><link rel="prefetch" href="/assets/js/35.d285264b.js"><link rel="prefetch" href="/assets/js/36.44d3152b.js"><link rel="prefetch" href="/assets/js/37.b076d761.js"><link rel="prefetch" href="/assets/js/38.ad1f27c7.js"><link rel="prefetch" href="/assets/js/39.413161ea.js"><link rel="prefetch" href="/assets/js/4.15836b88.js"><link rel="prefetch" href="/assets/js/40.ba4bef5e.js"><link rel="prefetch" href="/assets/js/41.6fbb1017.js"><link rel="prefetch" href="/assets/js/42.80c5b28a.js"><link rel="prefetch" href="/assets/js/43.3f0aeafe.js"><link rel="prefetch" href="/assets/js/44.c08a8e84.js"><link rel="prefetch" href="/assets/js/46.cf98a01d.js"><link rel="prefetch" href="/assets/js/47.95ad89e2.js"><link rel="prefetch" href="/assets/js/48.11de7b32.js"><link rel="prefetch" href="/assets/js/49.89191d18.js"><link rel="prefetch" href="/assets/js/5.64f16959.js"><link rel="prefetch" href="/assets/js/50.d3c00218.js"><link rel="prefetch" href="/assets/js/51.270d7491.js"><link rel="prefetch" href="/assets/js/52.e303f682.js"><link rel="prefetch" href="/assets/js/53.6b37d452.js"><link rel="prefetch" href="/assets/js/54.5516a56a.js"><link rel="prefetch" href="/assets/js/55.1535f45c.js"><link rel="prefetch" href="/assets/js/56.fe5d6cd5.js"><link rel="prefetch" href="/assets/js/57.c78d418a.js"><link rel="prefetch" href="/assets/js/58.6a5328b4.js"><link rel="prefetch" href="/assets/js/59.9c425111.js"><link rel="prefetch" href="/assets/js/6.56b74cc5.js"><link rel="prefetch" href="/assets/js/60.8471b9ec.js"><link rel="prefetch" href="/assets/js/61.7f1373c2.js"><link rel="prefetch" href="/assets/js/62.3fa31180.js"><link rel="prefetch" href="/assets/js/63.9778d19f.js"><link rel="prefetch" href="/assets/js/64.7ec547c6.js"><link rel="prefetch" href="/assets/js/65.46b6abc2.js"><link rel="prefetch" href="/assets/js/66.41e96d6e.js"><link rel="prefetch" href="/assets/js/67.1e438865.js"><link rel="prefetch" href="/assets/js/68.ec61f597.js"><link rel="prefetch" href="/assets/js/69.a4ad7ed9.js"><link rel="prefetch" href="/assets/js/7.6e55be9c.js"><link rel="prefetch" href="/assets/js/70.ad9257f5.js"><link rel="prefetch" href="/assets/js/71.e45ee61f.js"><link rel="prefetch" href="/assets/js/72.cf56042d.js"><link rel="prefetch" href="/assets/js/73.5190c50f.js"><link rel="prefetch" href="/assets/js/74.a5427366.js"><link rel="prefetch" href="/assets/js/75.ea188344.js"><link rel="prefetch" href="/assets/js/76.69afb87b.js"><link rel="prefetch" href="/assets/js/77.91aca632.js"><link rel="prefetch" href="/assets/js/78.e5c052d0.js"><link rel="prefetch" href="/assets/js/79.a790ac95.js"><link rel="prefetch" href="/assets/js/8.ef38795e.js"><link rel="prefetch" href="/assets/js/80.65aec641.js"><link rel="prefetch" href="/assets/js/81.78289e97.js"><link rel="prefetch" href="/assets/js/82.08de41e8.js"><link rel="prefetch" href="/assets/js/83.ff9c1755.js"><link rel="prefetch" href="/assets/js/84.f86545fe.js"><link rel="prefetch" href="/assets/js/85.c883b25b.js"><link rel="prefetch" href="/assets/js/86.1d29daeb.js"><link rel="prefetch" href="/assets/js/87.9c24da6f.js"><link rel="prefetch" href="/assets/js/88.bcbf388d.js"><link rel="prefetch" href="/assets/js/89.e3aaff55.js"><link rel="prefetch" href="/assets/js/9.3f4a2127.js"><link rel="prefetch" href="/assets/js/90.23eda780.js"><link rel="prefetch" href="/assets/js/91.da84bead.js"><link rel="prefetch" href="/assets/js/92.7d2a6af1.js"><link rel="prefetch" href="/assets/js/93.4de0373f.js">
    <link rel="stylesheet" href="/assets/css/styles.c0a0368e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/" class="home-link router-link-active"><!----><span class="site-name">
      Information Theory
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><!----></div></header><div class="sidebar-mask"></div><div class="sidebar"><!----><ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading"><span>general information</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>01 probability theory</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>02 entropy</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>03 source coding data compression</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>04 typical sets and encryption</span><span class="arrow down"></span></p><ul class="sidebar-group-items"><li><a href="/04-typical-sets-and-encryption/typical-sets/convergence-of-random-variables/" class="sidebar-link">Convergence of Random Variables</a></li><li><a href="/04-typical-sets-and-encryption/typical-sets/the-weak-law-of-large-numbers/" class="sidebar-link">The Weak Law of Large Numbers</a></li><li><a href="/04-typical-sets-and-encryption/typical-sets/the-asymptotic-equipartition-property-aep/" class="sidebar-link">The Asymptotic Equipartition Property (AEP)</a></li><li><a href="/04-typical-sets-and-encryption/typical-sets/definition-typical-set/" class="sidebar-link">Definition: Typical Set</a></li><li><a href="/04-typical-sets-and-encryption/typical-sets/properties-of-typical-sets/" class="sidebar-link">Properties of Typical Sets</a></li><li><a href="/04-typical-sets-and-encryption/typical-sets/source-coding-using-typical-sets/" class="active sidebar-link">Source Coding using Typical Sets</a></li><li><a href="/04-typical-sets-and-encryption/conditional-mutual-information/definition-conditional-mutual-information/" class="sidebar-link">Definition: Conditional Mutual Information</a></li><li><a href="/04-typical-sets-and-encryption/conditional-mutual-information/the-chain-rule-for-mutual-information/" class="sidebar-link">The Chain Rule for Mutual Information</a></li><li><a href="/04-typical-sets-and-encryption/conditional-mutual-information/entropy-diagrams-for-three-random-variables/" class="sidebar-link">Entropy Diagrams for Three Random Variables</a></li><li><a href="/04-typical-sets-and-encryption/perfectly-secure-encryption/definition-perfectly-secure-encryption/" class="sidebar-link">Definition: Perfectly Secure Encryption</a></li><li><a href="/04-typical-sets-and-encryption/perfectly-secure-encryption/one-time-pad/" class="sidebar-link">One-Time Pad</a></li><li><a href="/04-typical-sets-and-encryption/perfectly-secure-encryption/minimum-key-length-for-perfectly-secure-encryption/" class="sidebar-link">Minimum Key Length for Perfectly Secure Encryption</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>05 random processes</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>06 error correction and zero error transmission</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>07 noisy channel coding</span><span class="arrow right"></span></p><!----></div></li></ul></div><div class="page"><div class="content"><h1 id="source-coding-using-typical-sets"><a href="#source-coding-using-typical-sets" aria-hidden="true" class="header-anchor">#</a> Source Coding using Typical Sets</h1><p>The concept of typical sets is useful for designing codes for a source \(P_X\). Instead of encoding the source symbol-by-symbol, we will encode the source symbols in blocks of \(n\) symbols at a time.</p><p>This strategy can be used to design either a lossy or a lossless code. For a lossy code, we notice that with overwhelming probability, a sequence of \(n\) iid samples from \(P_X\) is typical, so it suffices to assign binary labels of length (at most) \(\lceil n (H(X) + \epsilon)\rceil\) to the elements of \(A_{\epsilon}^{(n)}\), and assign some constant (dummy) codeword to all elements outside of the set. Decoding this dummy codeword will result in an error (data loss), but this error occurs with probability at most \(\epsilon\).</p><p>The above scheme can be extended to a lossless version by assigning longer labels to the elements outside of \(A_{\epsilon}^{(n)}\), for example binary labels of length \(\lceil \log |\mathcal{X}|^n\rceil = \lceil n \log |\mathcal{X}|\rceil\). An extra 'flag' bit is needed to indicate whether the element is inside or outside the typical set. For large enough \(n\), this code is quite efficient:</p><div class="content-box pad-box-mini border border-trbl border-round"><h4 style="color: #bc0031;"><strong>Theorem</strong></h4>
Let \(X_1, \ldots, X_n\) be i.i.d. real random variables with respect to the set \(\mathcal{X}\), and distributed according to \(P_X\). Let \(\epsilon &gt; 0\). Then there exists a lossless code \(\mathcal{X}^n \to \{0,1\}^*\) such that, for sufficiently large \(n\), \(\mathbb{E}[\frac{1}{n} \ell(X^n)] \leq H(X) + \epsilon\).
<p><span role="button" aria-controls="group1" aria-label="Toggler" aria-expanded="false" class="element_toggler"><span class="Button">Proof</span></span></p><div id="group1"><div class="content-box">Consider the code described above: the code consist of a flag bit (indicating whether or not the element is inside the typical set), followed by either a short label (for elements in the typical set) or a longer one (for elements outside of it). Let \(\epsilon' &gt; 0\) (we will specify the value of \(\epsilon'\) later). Let \(n\) be large enough such that \(P[A_{\epsilon'}^{(n)}] &gt; 1 - \epsilon'\) (see <a title="Properties of Typical Sets" href="https://canvas.uva.nl/courses/2205/pages/properties-of-typical-sets" data-api-endpoint="https://canvas.uva.nl/api/v1/courses/2205/pages/properties-of-typical-sets" data-api-returntype="Page">the second property of typical sets</a>). Then \begin{align} \mathbb{E}[\ell(X^n)] &amp;= \sum_{\vec{x} \in \mathcal{X}^n} P_{X^n}(\vec{x}) \ell(\vec{x})\\ &amp;= \sum_{\vec{x} \in A_{\epsilon'}^{(n)}} P_{X^n}(\vec{x}) \ell(\vec{x}) + \sum_{\vec{x} \not\in A_{\epsilon'}^{(n)}} P_{X^n}(\vec{x}) \ell(\vec{x})\\ &amp;\leq P[A_{\epsilon'}^{(n)}] \cdot (\lceil n (H(X) + \epsilon') \rceil + 1) + P[\overline{A_{\epsilon'}^{(n)}}] \cdot (\lceil n \log |\mathcal{X}| \rceil + 1)\\ &amp;\leq P[A_{\epsilon'}^{(n)}] \cdot (n (H(X) + \epsilon') + 2) + P[\overline{A_{\epsilon'}^{(n)}}] \cdot (n \log |\mathcal{X}| + 2)\\ &amp;\leq n ( H(X) + \epsilon') + \epsilon' \cdot n \log |\mathcal{X}| + 2\\ &amp;= n(H(X) + \epsilon), \end{align} where \(\epsilon = \epsilon' + \epsilon' \log |\mathcal{X}| + \frac{2}{n}\) (note that \(\epsilon\) can be made arbitrarily small by choosing \(\epsilon'\) and \(n\) wisely). The +1 in the first inequality is a consequence of the `flag' bit.</div></div></div><p>For large enough blocks of symbols, the flag bit becomes irrelevant. Typical sets thus allow the construction of an efficient code without the 1 bit of overhead that symbol codes may necessarily have. However, this efficiency is only guaranteed for 'sufficiently large \(n\)', a rather theoretical condition that may not be achievable in practice.</p><p>We conclude this chapter by showing that the typical set is in a sense 'optimal', i.e. that picking a smaller set instead of the typical set does not allow for much shorter codewords on average in a lossy setting, not even if we allow rather large error probabilities by allowing about half of the elements to lie outside of the typical set.</p><p>Let \(B_{\delta}^{(n)}\) denote the smallest subset of \(\mathcal{X}^n\) such that \(P[B_{\delta}^{(n)}] &gt; 1 - \delta\) (for some parameter \(\delta &gt; 0\)). \(B_{\delta}^{(n)}\) can be explicitly constructed by, for example, ordering \(\mathcal{X}^n\) in order of decreasing probability, and adding elements to \(B_{\delta}^{(n)}\) until the probability threshold of \(1 - \delta\) is reached. The following theorem states that even for large values of \(\delta\), we still need almost \(n H(X)\) bits to denote an element from \(B_{\delta}^{(n)}\).</p><div class="content-box pad-box-mini border border-trbl border-round"><h4 style="color: #bc0031;"><strong>Theorem</strong></h4>
Let \(X_1, \ldots, X_n\) be i.i.d. random variables distributed according to \(P_X\). For any \(\delta &lt; \frac{1}{2}\), and any \(\delta' &gt; 0\), if \(P[B_{\delta}^{(n)}] &gt; 1 - \delta\), then \[ \frac{1}{n} \log |B_{\delta}^{(n)}| &gt; H(X) - \delta', \] for sufficiently large \(n\).
<p><span role="button" aria-controls="group2" aria-label="Toggler" aria-expanded="false" class="element_toggler"><span class="Button">Proof</span></span></p><div id="group2"><div class="content-box">Let \(\delta,\epsilon &lt; \frac{1}{2}\), and consider some \(B_{\delta}^{(n)}\) such that \(P[B_{\delta}^{(n)}] &gt; 1 - \delta\). By <a title="Properties of Typical Sets" href="https://canvas.uva.nl/courses/2205/pages/properties-of-typical-sets" data-api-endpoint="https://canvas.uva.nl/api/v1/courses/2205/pages/properties-of-typical-sets" data-api-returntype="Page">the second property of typical sets</a>, \(P[A_{\epsilon}^{(n)}] &gt; 1 - \epsilon\), for large enough \(n\). Thus, by the union bound, \begin{align} 1 - \epsilon - \delta &amp;&lt; 1 - P[\overline{A_{\epsilon}^{(n)}}] - P[\overline{B_{\delta}^{(n)}}]\\ &amp;\leq 1-P[\overline{A_{\epsilon}^{(n)}} \cup \overline{B_{\delta}^{(n)}}]\\ &amp;= P[A_{\epsilon}^{(n)} \cap B_{\delta}^{(n)}]\\ &amp;= \sum_{\vec{x} \in A_{\epsilon}^{(n)} \cap B_{\delta}^{(n)}} P_{X^n}(\vec{x})\\ &amp;\leq \sum_{\vec{x} \in A_{\epsilon}^{(n)} \cap B_{\delta}^{(n)}} 2^{-n(H(X) - \epsilon)}\\ &amp;= |A_{\epsilon}^{(n)} \cap B_{\delta}^{(n)}| \cdot 2^{-n(H(X) - \epsilon)}\\ &amp;\leq |B_{\delta}^{(n)}| \cdot 2^{-n(H(X) - \epsilon)}. \end{align} Rearranging this expression and taking the logarithm, we get \begin{align} H(X) - \epsilon + \frac{1}{n} \log (1 - \epsilon - \delta) &lt; \frac{1}{n} \log |B_{\delta}^{(n)}|. \end{align} If we now set \(\delta' := \epsilon - \frac{1}{n} \log (1 - \epsilon - \delta)\), then \begin{align} H(X) - \delta' &lt; \frac{1}{n} \log |B_{\delta}^{(n)}|, \end{align} as desired. Observe that we can make the expression for \(\delta'\) as small as desired by choosing a small enough \(\epsilon&gt;0\) and a large enough \(n\), even if \(\delta\) is rather large.</div></div></div><p></p></div><!----><div class="content page-nav"><p class="inner"><span class="prev">
        ← <a href="/04-typical-sets-and-encryption/typical-sets/properties-of-typical-sets/" class="prev">
          Properties of Typical Sets
        </a></span><span class="next"><a href="/04-typical-sets-and-encryption/conditional-mutual-information/definition-conditional-mutual-information/">
          Definition: Conditional Mutual Information
        </a> →
      </span></p></div></div></div></div>
    <script src="/assets/js/45.2da068e9.js" defer></script><script src="/assets/js/app.c0a0368e.js" defer></script>
  </body>
</html>
