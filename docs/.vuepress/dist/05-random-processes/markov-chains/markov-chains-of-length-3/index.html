<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Information Theory | Markov Chains of Length 3</title>
    <meta name="description" content="UvA course">
    <script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [ ['$','$'], ['\\(','\\)'] ],processEscapes: true}});</script>
  <script src="/assets/js/MathJax.js?config=TeX-AMS_HTML"></script>
  <script type="application/javascript">function timeout() {setTimeout(function() {MathJax.Hub.Queue(["Typeset", MathJax.Hub]);timeout();}, 1000)};MathJax.Hub.Queue(["Typeset", MathJax.Hub]);timeout();</script>
    
    <link rel="preload" href="/assets/css/styles.c0a0368e.css" as="style"><link rel="preload" href="/assets/js/app.c0a0368e.js" as="script"><link rel="preload" href="/assets/js/52.e303f682.js" as="script"><link rel="prefetch" href="/assets/js/1.b42459b0.js"><link rel="prefetch" href="/assets/js/10.efcd0718.js"><link rel="prefetch" href="/assets/js/11.b96ece95.js"><link rel="prefetch" href="/assets/js/12.e1fc2cb5.js"><link rel="prefetch" href="/assets/js/13.281a42d7.js"><link rel="prefetch" href="/assets/js/14.321f3d63.js"><link rel="prefetch" href="/assets/js/15.2497a21d.js"><link rel="prefetch" href="/assets/js/16.55966313.js"><link rel="prefetch" href="/assets/js/17.99831763.js"><link rel="prefetch" href="/assets/js/18.b2da39df.js"><link rel="prefetch" href="/assets/js/19.783f6fe5.js"><link rel="prefetch" href="/assets/js/2.4174b9dd.js"><link rel="prefetch" href="/assets/js/20.31a487d3.js"><link rel="prefetch" href="/assets/js/21.a011af4c.js"><link rel="prefetch" href="/assets/js/22.e03bc349.js"><link rel="prefetch" href="/assets/js/23.4463ce34.js"><link rel="prefetch" href="/assets/js/24.b076e7c4.js"><link rel="prefetch" href="/assets/js/25.a123cda5.js"><link rel="prefetch" href="/assets/js/26.c5548a4d.js"><link rel="prefetch" href="/assets/js/27.91697a5a.js"><link rel="prefetch" href="/assets/js/28.26582aab.js"><link rel="prefetch" href="/assets/js/29.cc517640.js"><link rel="prefetch" href="/assets/js/3.4c5adbde.js"><link rel="prefetch" href="/assets/js/30.3ca179bc.js"><link rel="prefetch" href="/assets/js/31.3e961e9b.js"><link rel="prefetch" href="/assets/js/32.eb1a29f5.js"><link rel="prefetch" href="/assets/js/33.14f4f43a.js"><link rel="prefetch" href="/assets/js/34.af720415.js"><link rel="prefetch" href="/assets/js/35.d285264b.js"><link rel="prefetch" href="/assets/js/36.44d3152b.js"><link rel="prefetch" href="/assets/js/37.b076d761.js"><link rel="prefetch" href="/assets/js/38.ad1f27c7.js"><link rel="prefetch" href="/assets/js/39.413161ea.js"><link rel="prefetch" href="/assets/js/4.15836b88.js"><link rel="prefetch" href="/assets/js/40.ba4bef5e.js"><link rel="prefetch" href="/assets/js/41.6fbb1017.js"><link rel="prefetch" href="/assets/js/42.80c5b28a.js"><link rel="prefetch" href="/assets/js/43.3f0aeafe.js"><link rel="prefetch" href="/assets/js/44.c08a8e84.js"><link rel="prefetch" href="/assets/js/45.2da068e9.js"><link rel="prefetch" href="/assets/js/46.cf98a01d.js"><link rel="prefetch" href="/assets/js/47.95ad89e2.js"><link rel="prefetch" href="/assets/js/48.11de7b32.js"><link rel="prefetch" href="/assets/js/49.89191d18.js"><link rel="prefetch" href="/assets/js/5.64f16959.js"><link rel="prefetch" href="/assets/js/50.d3c00218.js"><link rel="prefetch" href="/assets/js/51.270d7491.js"><link rel="prefetch" href="/assets/js/53.6b37d452.js"><link rel="prefetch" href="/assets/js/54.5516a56a.js"><link rel="prefetch" href="/assets/js/55.1535f45c.js"><link rel="prefetch" href="/assets/js/56.fe5d6cd5.js"><link rel="prefetch" href="/assets/js/57.c78d418a.js"><link rel="prefetch" href="/assets/js/58.6a5328b4.js"><link rel="prefetch" href="/assets/js/59.9c425111.js"><link rel="prefetch" href="/assets/js/6.56b74cc5.js"><link rel="prefetch" href="/assets/js/60.8471b9ec.js"><link rel="prefetch" href="/assets/js/61.7f1373c2.js"><link rel="prefetch" href="/assets/js/62.3fa31180.js"><link rel="prefetch" href="/assets/js/63.9778d19f.js"><link rel="prefetch" href="/assets/js/64.7ec547c6.js"><link rel="prefetch" href="/assets/js/65.46b6abc2.js"><link rel="prefetch" href="/assets/js/66.41e96d6e.js"><link rel="prefetch" href="/assets/js/67.1e438865.js"><link rel="prefetch" href="/assets/js/68.ec61f597.js"><link rel="prefetch" href="/assets/js/69.a4ad7ed9.js"><link rel="prefetch" href="/assets/js/7.6e55be9c.js"><link rel="prefetch" href="/assets/js/70.ad9257f5.js"><link rel="prefetch" href="/assets/js/71.e45ee61f.js"><link rel="prefetch" href="/assets/js/72.cf56042d.js"><link rel="prefetch" href="/assets/js/73.5190c50f.js"><link rel="prefetch" href="/assets/js/74.a5427366.js"><link rel="prefetch" href="/assets/js/75.ea188344.js"><link rel="prefetch" href="/assets/js/76.69afb87b.js"><link rel="prefetch" href="/assets/js/77.91aca632.js"><link rel="prefetch" href="/assets/js/78.e5c052d0.js"><link rel="prefetch" href="/assets/js/79.a790ac95.js"><link rel="prefetch" href="/assets/js/8.ef38795e.js"><link rel="prefetch" href="/assets/js/80.65aec641.js"><link rel="prefetch" href="/assets/js/81.78289e97.js"><link rel="prefetch" href="/assets/js/82.08de41e8.js"><link rel="prefetch" href="/assets/js/83.ff9c1755.js"><link rel="prefetch" href="/assets/js/84.f86545fe.js"><link rel="prefetch" href="/assets/js/85.c883b25b.js"><link rel="prefetch" href="/assets/js/86.1d29daeb.js"><link rel="prefetch" href="/assets/js/87.9c24da6f.js"><link rel="prefetch" href="/assets/js/88.bcbf388d.js"><link rel="prefetch" href="/assets/js/89.e3aaff55.js"><link rel="prefetch" href="/assets/js/9.3f4a2127.js"><link rel="prefetch" href="/assets/js/90.23eda780.js"><link rel="prefetch" href="/assets/js/91.da84bead.js"><link rel="prefetch" href="/assets/js/92.7d2a6af1.js"><link rel="prefetch" href="/assets/js/93.4de0373f.js">
    <link rel="stylesheet" href="/assets/css/styles.c0a0368e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/" class="home-link router-link-active"><!----><span class="site-name">
      Information Theory
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><!----></div></header><div class="sidebar-mask"></div><div class="sidebar"><!----><ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading"><span>general information</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>01 probability theory</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>02 entropy</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>03 source coding data compression</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>04 typical sets and encryption</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>05 random processes</span><span class="arrow down"></span></p><ul class="sidebar-group-items"><li><a href="/05-random-processes/markov-chains/markov-chains-of-length-3/" class="active sidebar-link">Markov Chains of Length 3</a></li><li><a href="/05-random-processes/markov-chains/data-processing-inequality/" class="sidebar-link">Data-Processing Inequality</a></li><li><a href="/05-random-processes/markov-chains/sufficient-statistics/" class="sidebar-link">Sufficient Statistics</a></li><li><a href="/05-random-processes/markov-chains/definition-longer-markov-chains/" class="sidebar-link">Definition: Longer Markov Chains</a></li><li><a href="/05-random-processes/stochastic-processes/discrete-time-stochastic-process/" class="sidebar-link">Discrete-Time Stochastic Process</a></li><li><a href="/05-random-processes/stochastic-processes/stationary-process/" class="sidebar-link">Stationary Process</a></li><li><a href="/05-random-processes/stochastic-processes/markov-process-time-invariance-finite-state-transition-matrix/" class="sidebar-link">Markov Process: Time Invariance, Finite State, Transition Matrix</a></li><li><a href="/05-random-processes/stochastic-processes/markov-process-stationary-distribution/" class="sidebar-link">Markov Process: Stationary Distribution</a></li><li><a href="/05-random-processes/stochastic-processes/markov-process-irreducibility-periodicity-convergence/" class="sidebar-link">Markov Process: Irreducibility, Periodicity, Convergence</a></li><li><a href="/05-random-processes/entropy-rate/entropy-rate/" class="sidebar-link">Entropy Rate</a></li><li><a href="/05-random-processes/entropy-rate/aep-for-ergodic-stationary-processes/" class="sidebar-link">AEP for Ergodic Stationary Processes</a></li><li><a href="/05-random-processes/more-markov-processes/random-walks-on-graphs/" class="sidebar-link">Random Walks on Graphs</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>06 error correction and zero error transmission</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>07 noisy channel coding</span><span class="arrow right"></span></p><!----></div></li></ul></div><div class="page"><div class="content"><h1 id="markov-chains-of-length-3"><a href="#markov-chains-of-length-3" aria-hidden="true" class="header-anchor">#</a> Markov Chains of Length 3</h1><p>So far in this course we have mostly seen independent random variables. In source coding, we designed our codes according to a single distribution \(P_X\), and assumed that if we encoded a sequence of source symbols, the symbols in the sequence would be drawn independently according to \(P_X\). In the real world, however, subsequent events are often dependent on each other. For example, in an English text, after observing a letter \( \texttt{q} \), the next letter is much more likely to be \( \texttt{u} \) than it is to be \( \texttt{r} \), even though in general the letter \( \texttt{r} \) is more prevalent in English text. The event of observing the letter \(\texttt{q}\) changes the probability distribution of the next letter. We start by studying a restricted form of dependence between variables: Markov chains. Random variables form a Markov chain if the distribution of each random variable depends only on the outcome of the random variable that directly precedes it.</p><div class="content-box pad-box-mini border border-trbl border-round"><h4 style="color: #bc0031;"><strong>Definition: Markov chain (of length 3)</strong></h4>
The random variables \(X, Y,\) and \(Z\) form a Markov chain (notation: \(X \to Y \to Z\)) if and only if \[ P_{Z|XY} = P_{Z|Y}. \]</div><p>In this chapter, we regularly use the shortcut \(P_{Z|XY} = P_{Z|Y}\) to denote that this equality should hold for all possible input values, i.e. \begin{align} P_{Z|XY} = P_{Z|Y} \qquad \Leftrightarrow \qquad \forall x \in \mathcal{X}, y \in \mathcal{Y}, z \in \mathcal{Z}: P_{Z|XY}(z|x,y) = P_{Z|Y}(z|y) \, . \end{align}</p><div class="content-box pad-box-mini border border-trbl border-round"><h4 style="color: #bc0031;"><strong>Proposition</strong></h4>
For all random variables \(X,Y,Z\), the following statements are equivalent:
<ol type="a"><li>\(X \to Y \to Z\),</li><li>\(Z \to Y \to X\),</li><li>\(P_{XZ|Y} = P_{X|Y} \cdot P_{Z|Y}\) (that is, \(I(X;Z|Y) = 0\)). </li></ol><p><span role="button" aria-controls="group1" aria-label="Toggler" aria-expanded="false" class="element_toggler"><span class="Button">Proof</span></span></p><div id="group1"><div class="content-box">We prove that (a) \(\Rightarrow\) (b), that (b) \(\Rightarrow\) (c), and that (c) \(\Rightarrow\) (a). All other directions follow from (combinations of) these three implications.</div><ul><li>[(a) \(\Rightarrow\) (b):] Suppose \(X \to Y \to Z\). Then \begin{align} P_{X|YZ} &amp;= \frac{P_{XYZ}}{P_{YZ}} = \frac{P_{XY} \cdot P_{Z|XY}}{P_{YZ}} = \frac{P_{XY} \cdot P_{Z|XY}}{P_Y \cdot P_{Z|Y}}\\ &amp;= \frac{P_{XY} \cdot P_{Z|Y}}{P_Y \cdot P_{Z|Y}} = \frac{P_{XY}}{P_Y} = P_{X|Y}, \end{align} where we go from the top to the bottom line using the assumption that \(X \to Y \to Z\).</li><li>[(b) \(\Rightarrow\) (c):] Suppose \(Z \to Y \to X\). Then \begin{align} P_{XZ|Y} &amp;= \frac{P_{XYZ}}{P_Y} = \frac{P_{X|YZ} \cdot P_{YZ}}{P_Y}\\ &amp;= \frac{P_{X|Y} \cdot P_{YZ}}{P_Y} = P_{X|Y} \cdot \frac{P_{YZ}}{P_Y} = P_{X|Y} \cdot P_{Z|Y}, \end{align} where we go from the top to the bottom line using the assumption that \(Z \to Y \to X\).</li><li>[(c) \(\Rightarrow\) (a):] For the final implication, suppose that \(P_{XZ|Y} = P_{X|Y} \cdot P_{Z|Y}\). Then \begin{align} P_{Z|YX} &amp;= \frac{P_{XYZ}}{P_{XY}} = \frac{P_{XZ|Y} \cdot P_Y}{P_{XY}}\\ &amp;= \frac{P_{X|Y} \cdot P_{Z|Y} \cdot P_Y}{P_{XY}} = \frac{P_{XY} \cdot P_{Z|Y}}{P_{XY}} = P_{Z|Y}, \end{align} and therefore \(X \to Y \to Z\).</li></ul></div></div><p>Because of the equivalence of items (a) and (b), we often write \(X \leftrightarrow Y \leftrightarrow Z\) to denote a Markov chain.</p><div class="content-box pad-box-mini border border-trbl border-round"><h4 style="color: #2d3b45;"><strong>Example: Whispering game</strong></h4>
Alice, Bob and Charlie play a game: Alice comes up with a message, and whispers it into Bob's ear. Bob then proceeds to whisper the message into Charlie's ear, who says it out loud. Of course, Bob and Charlie may not hear the message correctly: there is some noise in the communication. Let \(A\) be the random variable that contains the message that Alice picks. For simplicity, let's say she picks a uniformly random bit. Let \(B\) be the message that Bob heard: it is also a bit, but with probability 0.1, it is not the same as \(A\). More formally, \begin{align*} P_{B|A}(0|0) = P_{B|A}(1|1) &amp;= 0.9,\\ P_{B|A}(1|0) = P_{B|A}(0|1) &amp;= 0.1.\\ \end{align*} Finally, let \(C\) be the message that Charlie heard: again, let us suppose that it is unequal to the whispered message \(B\) with probability 0.1. For the conditional distribution of \(C\), we see that \(P_{C|AB}(0|00) = 0.9 = P_{C|B}(0|0)\), and similarly for all other possible values of \(A\), \(B\), and \(C\). Thus, these random variables form a Markov chain: \(A \to B \to C\). The proposition above tells us that we can also look at this game in the converse direction: if we are curious about Alice's original message \(A\), we only have to look at Bob's interpretation \(B\) of the message. Additionally knowing Charlie's interpretation \(C\) does not change the distribution of \(A\).</div></div><!----><div class="content page-nav"><p class="inner"><span class="prev">
        ← <a href="/04-typical-sets-and-encryption/perfectly-secure-encryption/minimum-key-length-for-perfectly-secure-encryption/" class="prev">
          Minimum Key Length for Perfectly Secure Encryption
        </a></span><span class="next"><a href="/05-random-processes/markov-chains/data-processing-inequality/">
          Data-Processing Inequality
        </a> →
      </span></p></div></div></div></div>
    <script src="/assets/js/52.e303f682.js" defer></script><script src="/assets/js/app.c0a0368e.js" defer></script>
  </body>
</html>
