<p>The two following theorems give necessary and sufficient conditions for the existence of a prefix-free code or a uniquely decodable code for a given set of codeword lengths.</p>
<div class="content-box pad-box-mini border border-trbl border-round">
<h4 style="color: #bc0031;"><strong>Theorem: Kraft's inequality</strong></h4>
Let \(\{\ell_1, \ell_2, \ldots, \ell_m \}\) be a set of \(m\) positive natural numbers. There exists a prefix-free code with image \({\cal C} = \{c_1, \ldots, c_m\}\) and codeword lengths \(\ell(c_i) = \ell_i\), if and only if \[ \sum_{i=1}^m 2^{-\ell_i} \leq 1. \]
<p><span class="element_toggler" role="button" aria-controls="group4" aria-label="Toggler" aria-expanded="false"><span class="Button">\(\Rightarrow\)</span></span></p>
<div id="group4" style="">For the forward direction, suppose we have a prefix-free code \(C\) with image \({\cal C} = \{c_1, \ldots, c_m\}\) and codeword lengths \(\ell(c_i) = \ell_i \). View this code as a tree, with codewords only on the leaves (but not necessarily all the leaves), and assign a weight of \(2^{-d}\) to every node in the tree at depth \(d\) (including the leaves):
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/docs/public/img/207712?verifier=jqDwg3qkygBSbXEpSgKvKR5pQ253L3dhltqYGPUZ" alt="-" width="124" height="170" data-api-endpoint="https://canvas.uva.nl/api/v1/courses/2205/files/207712" data-api-returntype="File"><a class="instructure_file_link" title="proof-kraft.svg" href="/docs/public/img/207712/download?verifier=jqDwg3qkygBSbXEpSgKvKR5pQ253L3dhltqYGPUZ&amp;wrap=1" data-api-endpoint="https://canvas.uva.nl/api/v1/courses/2205/files/207712" data-api-returntype="File"></a></p>
Note that the weight of each node is exactly the sum of the weight of its direct children, and thereby that the weight of the root is exactly the weight of all of the leaves. Since every codeword \(c_i\) resides on a leaf of depth \(\ell_i\) (but not all leaves are necessarily occupied), the weight of the root is <i>at least</i> the sum of all the codeword weights: \[ \sum_{i=1}^{m} 2^{-\ell_i} \leq 2^0 = 1. \]</div>
<p><span class="element_toggler" role="button" aria-controls="group5" aria-label="Toggler" aria-expanded="false"><span class="Button">\(\Leftarrow\)</span></span></p>
<div id="group5" style="">Shopping at the codeword supermarket as described in the following video: <a id="media_comment_maybe" class="instructure_file_link instructure_video_link" title="03MacKayShoppingCodewords.MP4" href="/docs/public/img/190998/download?verifier=dTZeDTTYdf0l2s5N6gkjYDxVva70uXqPIJ9b8IIB&amp;wrap=1" data-api-endpoint="https://canvas.uva.nl/api/v1/courses/2205/files/190998" data-api-returntype="File">03MacKayShoppingCodewords.MP4</a>
</div>
</div>
<p>A stronger version of Kraft's inequality holds as well, this time for uniquely decodable codes:</p>
<div class="content-box pad-box-mini border border-trbl border-round">
<h4 style="color: #bc0031;"><strong>Theorem: McMillan inequality</strong></h4>
For a uniquely decodable code with image \({\cal C} = \{c_1, \ldots, c_m\}\) and codeword lengths \(\ell_i := \ell(c_i)\), it holds that \[ \sum_{i=1}^m 2^{-\ell_i} \leq 1. \]
<p><span class="element_toggler" role="button" aria-controls="group6" aria-label="Toggler" aria-expanded="false"><span class="Button">Show proof</span></span></p>
<div id="group6" style="">
<div class="content-box">Let \({\cal C}\) be a uniquely decodable code as in the theorem statement. We can write \[ S := \sum_{c \in \cal C} \frac{1}{2^{\ell(c)}} = \sum_{\ell = L_{\min}}^{L_{\max}} \frac{n_\ell}{2^\ell} \] where \(L_{\min} = \min_{c \in \cal C} \ell(c)\), \(L_{\max} = \max_{c \in \cal C} \ell(c)\), and \(n_{\ell} = |\{c \in {\cal C}\mid \ell(c) = \ell\}|\). Furthermore, for any \(k \in \mathbb{N}\), consider the \(k\)th power of \(S\), \[ S^k = \sum_{c_1,\ldots,c_k \in \mathcal{C}^k} \frac{1}{2^{\ell(c_1)+\ldots+\ell(c_k)}} = \sum_{\ell = k L_{\min}}^{k L_{\max}} \frac{n_\ell^{(k)}}{2^\ell} \] where \(n_\ell^{(k)}\) is defined as \(n_\ell^{(k)} = \big|\big\{(c_1,\ldots,c_k) \in {\cal C}^k \mid \sum_i\ell(c_i) = \ell(c_1|\ldots|c_k) = \ell\big\}\big|\). Note that \[ n_\ell^{(k)} = \sum_{x \in \{0,1\}^{\ell}} \big|\{(c_1,\ldots,c_k) \in {\cal C}^k \mid \,c_1|\ldots|c_k = x\}\big| \leq \sum_{x \in \{0,1\}^{\ell}} 1 = 2^{\ell} \] where the inequality follows from the unique decodability of \(\cal C\). Thus, we can conclude that \[ S^k \leq (L_{\max} - L_{\min}) \cdot k \] for all \(k \in \mathbb{N}\), so \(S^k\) grows at most linearly in \(k\), from which follows that \(S \leq 1\) (for if not, \(S^k\) would grow exponentially in \(k\)).</div>
</div>
</div>
<p>Kraft's and McMillan's inequality together lead to the conclusion that the lengths of an optimal prefix-free code and an optimal uniquely decodable code coincide:</p>
<div class="content-box pad-box-mini border border-trbl border-round">
<h4 style="color: #bc0031;"><strong>Corollary</strong></h4>
Let \(P_X\) be a source. For every uniquely decodable code \(C\), there exists a prefix-free code \(C'\) such that \(\ell_C(P_X) = \ell_{C'}(P_X)\). Hence, \[ \ell_{\min}^{\text{p.f.}}(P_X) = \ell_{\min}^{\text{u.d.}}(P_X). \]</div>
<p>From now on, we will just write \(\ell_{\min}(P_X)\) to denote either of these measures for average length. A code \(C\) for which \(\ell_C(P_X) = \ell_{\min}(P_X)\) is called <span style="color: #bc0031;"><strong>optimal</strong></span> for the source \(P_X\).</p>