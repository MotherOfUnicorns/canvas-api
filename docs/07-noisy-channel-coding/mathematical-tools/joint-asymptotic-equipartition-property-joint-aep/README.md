# Joint Asymptotic Equipartition Property (Joint AEP)

<p>In the examples on the previous page, we have gathered some intuition about jointly typical sets. A (jointly) typical set is usually relatively small compared to the total sample space, but for large \(n\), much of the probability lies on its elements.</p>
<p>We also see the effect of mutual information between \(X\) and \(Y\). If \(X\) and \(Y\) are close to independent, the typical set has a rectangular shape: independently selecting a typical \(X\) sample and a typical \(Y\) sample will certainly yield a jointly typical element. On the other hand, if \(X\) and \(Y\) are highly dependent on each other, the typical set has a diagonal structure: there is a significant probability that sampling a typical \(X\) and a typical \(Y\) independently yields a pair that is not jointly typical. These observations lead us to a joint version of the <a title="The Asymptotic Equipartition Property" href="https://canvas.uva.nl/courses/10933/pages/the-asymptotic-equipartition-property" data-api-endpoint="https://canvas.uva.nl/api/v1/courses/10933/pages/the-asymptotic-equipartition-property" data-api-returntype="Page">asymptotic equipartition property</a>, describing some properties of jointly typical sets:</p>
<div class="content-box pad-box-mini border border-trbl border-round">
<h4 style="color: #bc0031;"><strong>Theorem: Joint Asymptotic Equipartition Property (Joint AEP)</strong></h4>
Let \(X^nY^n\) be i.i.d. with respect to \(P_{XY}\). Then:
<ol>
<li>\(P_{X^nY^n}(A_{\epsilon}^{(n)}) \xrightarrow{n \to \infty} 1\).</li>
<li>\(|A_{\epsilon}^{(n)}| \leq 2^{n(H(XY) + \epsilon)}\).</li>
<li>For random variables \(\tilde{X}\) and \(\tilde{Y}\), if \(\tilde{X}^n\tilde{Y}^n\) is i.i.d. with respect to \(P_X \cdot P_Y\), then \[P[(\tilde{X}^n\tilde{Y}^n) \in A_{\epsilon}^{(n)}] \leq 2^{-n(I(X;Y) - 3\epsilon)}.\]</li>
<li>For random variables \(\tilde{X}\) and \(\tilde{Y}\), if \(\tilde{X}^n\tilde{Y}^n\) is i.i.d. with respect to \(P_X \cdot P_Y\), then for large enough \(n\), \[P[(\tilde{X}^n\tilde{Y}^n) \in A_{\epsilon}^{(n)}] \geq (1-\epsilon)2^{-n(I(X;Y) + 3 \epsilon)}.\]</li>
</ol>
<p><span class="element_toggler" role="button" aria-controls="group5" aria-label="Toggler" aria-expanded="false"><span class="Button">Proof</span></span></p>
<div id="group5" style="">
<div class="content-box">
<p>We show the statements separately, for an arbitrary \(X^nY^n\) that is i.i.d. with respect to \(P_{XY}\).</p>
<ol>
<li>The first statement follows from the weak law of large numbers. Similarly to the <a title="The Asymptotic Equipartition Property" href="https://canvas.uva.nl/courses/10933/pages/the-asymptotic-equipartition-property" data-api-endpoint="https://canvas.uva.nl/api/v1/courses/10933/pages/the-asymptotic-equipartition-property" data-api-returntype="Page">proof of the asymptotic equipartition property</a>, we have that \begin{align} -\frac{1}{n} \log P_{X^n}(X^n) &amp;= - \frac{1}{n} \sum_{i=1}^n \log P_X(X) \\ &amp;\xrightarrow{p} - \mathbb{E}[\log P_X(X)] \\ &amp;= H(X). \end{align} Writing out the definition of convergence in probability, we have that for all \(\epsilon &gt; 0\), there exists an \(n_1 \in \mathbb{N}\) such that for all \(n &gt; n_1\), \begin{align} P\left[\left|-\frac{1}{n} \log P_{X^n}(X^n) - H(X)\right| \geq \epsilon \right] &amp;\leq P\left[\left|-\frac{1}{n} \log P_{X^n}(X^n) - H(X)\right| \geq \frac{\epsilon}{3} \right] \\ &amp;&lt; \frac{\epsilon}{3}. \end{align} In the above, we can divide \(\epsilon\) by 3 because the second inequality holds for <i>all</i> \(\epsilon &gt; 0\), so in particular also for \(\frac{\epsilon}{3}\). We can derive statements about \(Y^n\) and \(X^nY^n\) that are similar to this bound above. Doing so, we find \(n_2, n_3 \in \mathbb{N}\) for \(Y^n\) and \(X^nY^n\), respectively. For all \(\epsilon &gt; 0\), we can now choose \(n_0 := \max\{n_1,n_2,n_3\}\), and find that for all \(n &gt; n_0\), \begin{align} P\left[(X^n,Y^n) \in A_{\epsilon}^{(n)}\right] &amp;= 1 - P\left[(X^n,Y^n) \not\in A_{\epsilon}^{(n)}\right] \\&amp;\geq 1 - \Big( P\left[\left|-\frac{1}{n} \log P_{X^n}(X^n) - H(X)\right| \geq \epsilon \right] + \\&amp;\phantom{\geq 1 - \Big(}P\left[\left|-\frac{1}{n} \log P_{Y^n}(Y^n) - H(Y)\right| \geq \epsilon \right] + \\&amp;\phantom{\geq 1 - \Big(}P\left[\left|-\frac{1}{n} \log P_{X^nY^n}(X^nY^n) - H(XY)\right| \geq \epsilon \right]\Big)\\ &amp;\leq 1 - \left(\frac{\epsilon}{3} + \frac{\epsilon}{3} + \frac{\epsilon}{3}\right) \\&amp;= 1 - \epsilon. \end{align} The first inequality is due to the union bound, and the second follows from the inequality in the proof of the previous point, and its analogues. By definition of convergence, the first statement is proven.</li>
<li>Observe that by rewriting the last line in the definition of \(A_{\epsilon}^{(n)}\) in <a title="Definition: Joint Typicality" href="https://canvas.uva.nl/courses/10933/pages/definition-joint-typicality" data-api-endpoint="https://canvas.uva.nl/api/v1/courses/10933/pages/definition-joint-typicality" data-api-returntype="Page">the definition of joint typicality</a>, one can derive that for every element \((x^n,y^n) \in A_{\epsilon}^{(n)}\), \begin{align} P_{X^nY^n}(x^ny^n) &gt; 2^{-n(H(XY) + \epsilon)}. \end{align} The second statement follows by rearranging the following inequality: \begin{align} 1 &amp;= \sum_{(x^n,y^n) \in \mathcal{X}^n \times \mathcal{Y}^n} P_{X^nY^n}(x^n,y^n) \\&amp;\geq \sum_{(x^n,y^n) \in A_{\epsilon}^{(n)}} P_{X^nY^n}(x^n,y^n) \\&amp;\geq |A_{\epsilon}^{(n)}| \cdot 2^{-n(H(XY) + \epsilon)}. \end{align}</li>
<li>First, we write out the probability of sampling an element in the typical set, again by rearranging the inequalities in <a title="Definition: Joint Typicality" href="https://canvas.uva.nl/courses/10933/pages/definition-joint-typicality" data-api-endpoint="https://canvas.uva.nl/api/v1/courses/10933/pages/definition-joint-typicality" data-api-returntype="Page">the definition of joint typicality</a>. \begin{align} P[(\tilde{X}^n\tilde{Y}^n) \in A_{\epsilon}^{(n)}] &amp;= \sum_{(x^n,y^n) \in A_{\epsilon}^{(n)}} P_{\tilde{X}^n\tilde{Y}^n}(x^n,y^n) \\&amp;= \sum_{(x^n,y^n) \in A_{\epsilon}^{(n)}} P_{X^n}(x^n) \cdot P_{Y^n}(y^n) \\&amp;\leq |A_{\epsilon}^{(n)}|\cdot 2^{-n(H(X) - \epsilon)} \cdot 2^{-n(H(Y)-\epsilon)}. \end{align} Combining this with part (2) of this theorem, we get \begin{align} P[(\tilde{X}^n\tilde{Y}^n) \in A_{\epsilon}^{(n)}] &amp;\leq 2^{n(H(XY) + \epsilon)} \cdot 2^{-n(H(X) - \epsilon)} \cdot 2^{-n(H(Y)-\epsilon)} \\&amp;= 2^{-n(-H(XY) + H(X) + H(Y) -3\epsilon)} \\&amp;= 2^{-n(I(X;Y) - 3\epsilon)}. \end{align} This completes the proof of the third part.</li>
<li>By part (1), we have that \(P[A_{\epsilon}^{(n)}] \geq 1 - \epsilon\) for large enough \(n\). Thus, \begin{align} 1-\epsilon &amp;\leq P[A_{\epsilon}^{(n)}] \\&amp;= \sum_{(x^n,y^n) \in A_{\epsilon}^{(n)}} P_{X^nY^n}(x^n,y^n) \\&amp;\leq |A_{\epsilon}^{(n)}| 2^{-n(H(XY) - \epsilon)}. \end{align} Rearranging this inequality and using the same type of derivation as in the proof of (3), it follows that \begin{align} P[(\tilde{X}^n\tilde{Y}^n) \in A_{\epsilon}^{(n)}] &amp;= \sum_{(x^n,y^n) \in A_{\epsilon}^{(n)}} P_{X^n}(x^n) \cdot P_{Y^n}(y^n) \\&amp;\geq (1-\epsilon) \cdot 2^{n(H(XY) - \epsilon)} \cdot 2^{-n(H(X) + \epsilon)} \cdot 2^{-n(H(Y) + \epsilon)} \\&amp;= (1 - \epsilon) \cdot 2^{-n(I(X;Y) + 3\epsilon)}. \end{align}</li>
</ol>
</div>
</div>
</div>